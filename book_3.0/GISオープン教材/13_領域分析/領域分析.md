# 領域分析
　本教材は、「領域分析」の実習用教材です。GISソフトウェア（QGIS）を用いた、バッファなどの領域分析の手法について解説しています。
講義用教材として、[地理情報科学教育用スライド（GIScスライド）]の4章が参考になります。
　課題形式で使用する場合は、本教材を一読した後、[課題ページ](../課題/課題ページ/領域分析.md)へお進みください。GIS初学者は、本教材を進める前に[GISの基本概念]の教材を確認しておいてください。本教材を使用する際は、[利用規約]をご確認いただき、これらの条件に同意された場合にのみご利用下さい。

[地理情報科学教育用スライド（GIScスライド）]:http://curricula.csis.u-tokyo.ac.jp/slide/4.html
[利用規約]:../../../master/利用規約.md
[GISの基本概念]:../01_GISの基本概念/GISの基本概念.md

**Menu**
------
* [バッファによる領域分析](#バッファによる領域分析)
* [ボロノイ分割による領域分析](#ボロノイ分割による領域分析)
* [ドローネ三角形](#ドローネ三角形)

**使用データ**
　実習をはじめる前に、以下のデータをダウンロードしてください。なお、すべてのデータをJGD2000の平面直角座標系に統一して下さい国土数値情報のデータはダウンロード後に「JGD2000の平面直角座標系」へ座標変換する。国土数値情報データの読み込み時に空間参照設定のウィンドウが表示されたら、JGD2000を選択した後（QGIS2.8.4の場合）に変換の処理を行ってください。

* 国土交通省国土政策局「[国土数値情報]（愛知県　行政区域、郵便局、小学校、小学校区データ　全国　鉄道線、鉄道駅、空港データ）

>ダウンロード手法は、[既存データの地図データと属性データ]の教材を参考とする。座標系の変換手法は[空間データ]の教材を参考とする。名古屋市内のポリゴンは、愛知県のポリゴンから名古屋市を選択した状態（選択ツール）で、名前を付けて保存を実行する（この際に選択地物のみ...にチェックをつける）。その他のレイヤは、[基本的な空間解析]の教材を参考に用意する。

[国土数値情報]:http://nlftp.mlit.go.jp/ksj/index.html

**スライド教材**
スライドのダウンロードは[こちら](https://raw.githubusercontent.com/yamauchi-inochu/demo/master/GIS%E3%82%AA%E3%83%BC%E3%83%97%E3%83%B3%E6%95%99%E6%9D%90/13_%E9%A0%98%E5%9F%9F%E5%88%86%E6%9E%90/%E9%A0%98%E5%9F%9F%E5%88%86%E6%9E%90.pptx)

---

## バッファによる領域分析
　GISでは、地物からの距離に応じて一定の領域を作成する手法としてバッファがあります。バッファで抽出された領域は、例えば、コンビニエンスストアの新規出店者が、出店するコンビニから1000m以内の地物を検索したい場合等に使われます。以下では、QGISと国土数値情報よりダウンロードしたデータを利用し、ポイントからバッファを作成する手法や一定の距離に区切った多重リングバッファの作成手法について解説しています。また、バッファで作成した領域を用いた、空間検索についての解説も行っています。

### 点バッファの作成
愛知県の鉄道駅データを利用し、駅から500mのバッファを表示し、空間検索でバッファと重なる郵便局を抽出する。
![500mのバッファ](pic/13pic_1.png)
ベクタ＞空間演算ツール＞バッファ
① 駅を選択する。
② 円を近似させる線分の数10を入力する。（数が多いほどきれいな円になる）
③ 平面直角座標系であることを確認したのちに500を入力する。
④ 出力先と名称を指定する。
⑤ OKをクリックする。

(左)駅から500mのエリアが表示できた。
(右)バッファの結果を融合にチェックをいれた場合の例。
![500mのバッファ](pic/13pic_2.png)


### 空間検索を利用した抽出
以下では、空間検索を利用して、バッファと重なる地物を選択する手法について解説しています。

プラグイン＞プラグインの管理とインストール　を実行し、空間クエリプラグインにチェックを付ける。
![空間検索](pic/13pic_3.png)

ベクタ＞空間検索（S）＞空間検索（S）から空間検索を実行する。
![空間検索](pic/13pic_4.png)
① ソース地物の選択、郵便局を選択する。
② 範囲内を選択する。
③ buffer500mを選択する。
④ 適用をクリックする。

下の図のように、駅から500m圏内の郵便局が選択された。
![空間検索](pic/13pic_5.png)

### 選択した地物の保存
QGISでは、選択した郵便局のみ保存することができる。  
レイヤの上で右クリックし、「名前をつけて保存する」から「選択地物のみ保存する」にチェックを入れて保存する。
![空間検索](pic/13pic_6.png)


### 多重リングバッファ
多重リングバッファを実行するため、プラグイン＞プラグインの管理とインストール　からMulti-distance bufferをインストールする。
「プラグインをインストール」をクリックする。
![多重リングバッファ](pic/13pic_7.png)

ベクタ＞Multi-distance buffer＞Multi-distance buffer　から多重リングバッファを作成する。
![多重リングバッファ](pic/13pic_8.png)
① 駅を選択する。
② Addで距離を追加する。
③ 出力レイヤ名を入力する。
④ OKをクリックする。

200mごとの多重リングバッファができた。
「名前をつけて保存」から新規レイヤとして出力する。
![多重リングバッファ](pic/13pic_9.png)

属性データを用いて、200mごとの色分けを行う。
![多重リングバッファ](pic/13pic_10.png)

下の図のように、200mごとの多重リングバッファの表示が変更された。  
![多重リングバッファ](pic/13pic_11.png)


### 線バッファと面バッファ
同じ方法で、ラインやポリゴンからのバッファも作成できる。
![線バッファと面バッファ](pic/13pic_12.png)

[▲メニューへもどる]


## ボロノイ分割による領域分析
　GISでは、複数ある地物の位置関係に応じて領域を作成する手法としてボロノイ分割があります。ボロノイ分割は、複数ある地物間の最近隣勢力圏に応じて、地域を分割するものです。ボロノイ図を作成することで、最近隣勢力圏を求めることができます。以下では、QGISと国土数値情報の郵便局データを用いて、ボロノイ分割について解説しています。

ベクタ＞ジオメトリーツール＞ボロノイポリゴン　からボロノイ分割を実行する。
![ボロノイ分割](pic/13pic_13.png)
①郵便局を選択する。  
②出力場所と名称を入力する。
③OKをクリックする。
※バッファ領域の値が大きいほど、ボロノイポリゴンの一番外側の領域が大きくなる。

ボロノイ領域に分割された。
属性テーブルとして、ポイントの情報を保持していることを確認する。
![ボロノイ分割](pic/13pic_14.png)




[▲メニューへもどる]

## ドローネ三角形
　複数の地物から最も近い点を結び合わせ隣接関係を定義する手法としてドローネ三角形がある。以下では、QGISを用いてドローネ三角形図を作成する手法について解説している。

ベクタ＞ジオメトリーツール＞ドローネ三角形分割　からドローネ三角形分割を実行する。
![ドローネ三角形](pic/13pic_16.png)
① 小学校を選択する。
② 出力場所と名称を入力する。
③ OKをクリックする。

以下のように、ドローネ三角形による領域分割ができた。
![ドローネ三角形](pic/13pic_17.png)


[▲メニューへもどる]

**その他のライセンス**
本教材で利用しているキャプチャ画像の出典やクレジットについては、[その他のライセンスについて]よりご確認ください。

[▲メニューへもどる]:領域分析.md#menu
[その他のライセンスについて]:../その他のライセンスについて.md
[既存データの地図データと属性データ]:../07_既存データの地図データと属性データ/既存データの地図データと属性データ.md
[空間データ]:../08_空間データ/空間データ.md
[基本的な空間解析]:../13_基本的な空間解析/基本的な空間解析.md
