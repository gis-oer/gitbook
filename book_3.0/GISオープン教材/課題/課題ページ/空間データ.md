# 課題:空間データ
　この実習は、空間座標の変換、ジオリファレンス、ジオコーディングなどデータの保持する位置情報の変換やデータに位置情報を付加する手法について学ぶためのものです。GISでデータ分析をする場合、データの空間座標に注意する必要があります。データによって空間座標が異なっていると、位置ズレが生じ、データの処理が行えないことがあります。データに空間座標を付加する場合にも、注意が必要になります。

　手順とGISオープン教材の[空間データ]の教材を参考に、完成例のような地図が作成できれば、実習完了となります。実習で利用するデータの一部は、[既存データの地図データと属性データ]の教材を参考にダウンロードしてください。GIS初学者は、本教材を進める前に[GISの基本概念]の教材を確認しておいてください。


**Menu**
--------
* [空間座標の変換](#空間座標の変換)
* [ジオリファレンス](#ジオリファレンス)
* [ジオコーディング](#ジオコーディング)

**使用データ**
本課題では、以下のデータを使用しています。

- 政府統計の総合窓口([e-Stat])甲府市行政区画日本測地系と世界測地系のシェープファイルを利用

- [鯖江市オープンデータ]　古地図006（出典：越前鯖江５万石　ふるさと史跡紹介（2002年　鯖江地区まちづくり推進協議会　発行））

- [裾野市オープンデータ AED設置施設]　裾野市　AED設置施設データ（出典:[AED設置施設]、裾野市、クリエイティブ・コモンズ・ライセンス 表示 2.1（[https://creativecommons.org/licenses/by/2.1/jp/](https://creativecommons.org/licenses/by/2.1/jp/)） ））を教材用に加工（緯度経度などを削除）利用


## <a name="空間座標の変換"></a>空間座標の変換
　日本測地系と世界測地系のズレを示す地図を作成し、なぜズレが表示されるかについてWEB等で調べた後に、400字程度でまとめてください。また、地理座標系と投影座標系の違いについても400字程度でまとめてください。

　データは、[政府統計局e-stat]（平成２２年国勢調査（小地域））から、任意地域の日本測地系緯度経度・Shape形式と世界測地系平面直角座標系・Shape形式のデータをダウンロードしてください。それらのデータを用いて、両データが重なり合わない地図を作成してください。

※　最新の測地系はJGD2011であるが、QGIS2.8.4ではJGD2011の変換ができないため、本実習ではJGD2000を新測地系としている（2.14は、JGD2011に対応）。

### 完成例
![完成例](pic/8-1.png)

### 手順
①　e-statから任意の地域の異なる測地系のシェープファイル（平面直角座標系）をダウンロードする

②　QGISでデータを表示する（デフォルトでは、ずれて表示されないため、右下のボタンから、オンザフライ投影をクリックし、チェックをはずす）

③　QGISビギナーズマニュアルを参考に、地図をレイアウトする

④　レイアウト後に旧測地系データを新測地系に変換する（地図データが重なればOK）

⑤　新測地系に変換した投影座標系のデータを地理座標系に変換する。

⑥　QGISの作業ファイル（.qgs）に任意の名前をつけ保存し、画面を閉じる

-------
## <a name="ジオリファレンス"></a>ジオリファレンス
　ジオリファレンスは、位置情報のもたない画像などのデータに位置情報を持たせる際に用いる手法です。鯖江市のオープンデータより古地図006をダウンロードし、地理院タイルをもとにGCPを取得し、完成例のようにジオリファレンスした図を作成してください（なお、地理院タイルが利用できない場合は、基盤地図情報2500基本項目鯖江市道路等を利用すること）。

### 完成例
![完成例](pic/8-2.png)

### 手順
① [鯖江市のオープンデータ](https://www.city.sabae.fukui.jp/about_city/opendata/data_list/jpeg-sabae-chizu.html)より古地図006をダウンロードする。

② [sabae_sample](https://raw.githubusercontent.com/yamauchi-inochu/demo/master/GIS%E3%82%AA%E3%83%BC%E3%83%97%E3%83%B3%E6%95%99%E6%9D%90/%E8%AA%B2%E9%A1%8C/sample/sabae_sample.zip)とタイルレイヤプラグインを用いて地理院タイル（標準地図など）を読み込んでおく

④ 古地図を読み込みQGISのジオリファレンサーを起動する

⑤ ジオリファレンサーの利用法を参考に、古地図007にGCP(Ground Control Point)を付加する(完全には一致しないため、おおまかでよい)

⑥ QGISビギナーズマニュアルを参考に、地図をレイアウトする(古地図のプロパティを開き、画像を透過すると良い)

⑦ QGISの作業ファイル（.qgs）に任意の名前をつけ保存し、画面を閉じる

※ 今回は必要ないが、ジオリファレンスで高い位置精度を求める場合は、基盤地図情報の道路縁等の高精度のベクトルデータを用いることが望ましい。

-------

## <a name="ジオコーディング"></a>ジオコーディング
　ジオコーディングは、緯度経度や住所などの情報を保持したテキストファイル等を用いてGISで扱えるデータを作成する手法です。裾野市広域避難地・指定避難所の住所情報等をまとめたサンプルデータ[susono_AED.csv]を用いて、ジオコーディング（アドレスマッチング)を行い完成例のような地図を作成して下さい。

完成例**
![完成例](pic/8-3.png)

### 手順
① [susono_AED.csv]のfx（経度）とfy（緯度）のフィールドを利用し、QGISでCSVデータを読み込む。

② QGISで読み込んだCSVデータを名前を付けて保存から新規のシェープファイルとして出力する。名前を付けて保存のデータ形式を`ESRI Shapefile`に切り替え、CRSはJGD2000とする。

③ [空間座標の変換] の教材を参考に、②で作成したシェープファイルを世界測地系の平面直角座標系第Ⅷ系に変換する（名前を付けて保存から、新規のデータ作成を行う）。

④ [QGISビギナーズマニュアル]を参考に、地図をレイアウトする(背景地図を設定すると良い)。

[△メニューへもどる]



#### 完成例で使用したデータ
本ページで使用しているデータの出典については、該当する教材よりご確認ください。

[△メニューへもどる]:空間データ.md#menu
[QGISビギナーズマニュアル]:../../QGISビギナーズマニュアル/QGISビギナーズマニュアル.md
[GRASSビギナーズマニュアル]:../../GRASSビギナーズマニュアル/GRASSビギナーズマニュアル.md
[GISの基本概念]:../../01_GISの基本概念/GISの基本概念.md
[既存データの地図データと属性データ]:../../07_既存データの地図データと属性データ/既存データの地図データと属性データ.md
[空間データ]:../../08_空間データ/空間データ.md
[空間データの結合・修正]:../../10_空間データの統合・修正/空間データの統合・修正.md
[視覚的伝達]:../../21_視覚的伝達/視覚的伝達.md
[政府統計局e-stat]:https://www.e-stat.go.jp/SG1/estat/eStatTopPortal.do
[国土数値情報]:http://nlftp.mlit.go.jp/ksj/
[基本的な空間解析]:../../11_基本的な空間解析/基本的な空間解析.md
[ネットワーク分析]:../../12_ネットワーク分析/ネットワーク分析.md
[領域分析]:../../13_領域分析/領域分析.md
[点データの分析]:../../14_点データの分析/点データの分析.md
[ラスタデータの分析]:../../15_ラスタデータの分析/ラスタデータの分析.md
[空間補間]:../../18_空間補間/空間補間.md
[裾野市オープンデータ AED設置施設]:http://linkdata.org/work/rdf1s1034i
[鯖江市オープンデータ]:http://www.city.sabae.fukui.jp/pageview.html?id=12768
[空間座標の変換]:../../08_空間データ/空間データ.md#空間座標の変換(測地系変換、投影変換)
[susono_AED.csv]:https://github.com/yamauchi-inochu/demo/blob/master/GISオープン教材/課題/sample/susono_sample.zip?raw=true
